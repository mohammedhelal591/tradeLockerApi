import{a as x,b as d,c as C,d as E,e as T,f as p,g as F,h as N,i as D,j as I}from"./chunk-C3VLOL6R.js";import{f as y,k}from"./chunk-7D26SDIZ.js";import"./chunk-ZIEV5ZTI.js";import{$a as m,Aa as f,Sa as v,Za as a,_ as u,_a as n,ba as h,bb as b,jb as s,kb as w,mb as S}from"./chunk-V5GLINCU.js";var c=class extends Error{};c.prototype.name="InvalidTokenError";function _(r){return decodeURIComponent(atob(r).replace(/(.)/g,(e,l)=>{let o=l.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function $(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return _(e)}catch{return atob(e)}}function G(r,e){if(typeof r!="string")throw new c("Invalid token specified: must be a string");e||(e={});let l=e.header===!0?0:1,o=r.split(".")[l];if(typeof o!="string")throw new c(`Invalid token specified: missing part #${l+1}`);let t;try{t=$(o)}catch(i){throw new c(`Invalid token specified: invalid base64 for part #${l+1} (${i.message})`)}try{return JSON.parse(t)}catch(i){throw new c(`Invalid token specified: invalid json for part #${l+1} (${i.message})`)}}var O=(()=>{let e=class e{constructor(){this.authService=u(k),this.router=u(y),this.title="Login",this.loginForm=new T({email:new p("",d.required),password:new p("",d.required),server:new p("",d.required)})}save(o){this.authService.login(o).subscribe({next:t=>{if(console.log(t),t.accessToken){this.authService.isLoggedIn=!0,this.authService.accessToken.set(t.accessToken);let i=G(this.authService.accessToken()),g=JSON.stringify(i);localStorage.setItem("accessToken",t.accessToken),localStorage.setItem("decodedToken",g),this.router.navigate(["/home"])}},error:t=>{}})}};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h({type:e,selectors:[["app-login"]],standalone:!0,features:[S],decls:27,vars:2,consts:[[1,"container","p-5","bg-white","rounded","shadow-lg"],[1,"text-center"],[1,"container"],[1,"row"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","email",1,"form-label"],["type","email","formControlName","email",1,"form-control"],["for","password",1,"form-label"],["type","password","formControlName","password",1,"form-control"],["for","server",1,"form-label"],["type","text","formControlName","server",1,"form-control"],[1,"mb-3","text-center"],["target","_blank","href","https://login.ospreyfx.com/signup"],["type","submit",1,"btn","btn-primary"]],template:function(t,i){t&1&&(a(0,"div",0)(1,"div")(2,"h2",1),s(3),n()(),a(4,"div",2)(5,"div",3)(6,"form",4),b("ngSubmit",function(){return i.save(i.loginForm.value)}),a(7,"div",5)(8,"label",6),s(9,"Email"),n(),m(10,"input",7),n(),a(11,"div",5)(12,"label",8),s(13,"Password"),n(),m(14,"input",9),n(),a(15,"div",5)(16,"label",10),s(17,"Server"),n(),m(18,"input",11),n(),a(19,"div",12)(20,"h4"),s(21,"Don't have an account ? Register "),a(22,"a",13),s(23,"here"),n()()(),a(24,"div",5)(25,"button",14),s(26,"Login"),n()()()()()()),t&2&&(f(3),w(i.title),f(3),v("formGroup",i.loginForm))},dependencies:[I,F,x,C,E,N,D]});let r=e;return r})();export{O as LoginComponent};
